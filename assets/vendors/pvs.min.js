(function(a,i){typeof exports=="object"&&typeof module<"u"?module.exports=i():typeof define=="function"&&define.amd?define(i):(a=typeof globalThis<"u"?globalThis:a||self,a.pvs=i())})(this,function(){"use strict";const a=".nav-link > .label";function i(e,t){const s=e.textContent;s.substring(0,2)===t&&(e.textContent=s.substring(2))}function g(e=null){(e||document.querySelectorAll(a)).forEach(t=>{i(t,"- "),i(t,"# ")})}g(),new MutationObserver(e=>{e.forEach(t=>{t.type==="childList"&&t.addedNodes.forEach(s=>{s.nodeType===Node.ELEMENT_NODE&&s.querySelector&&s.tagName==="SPAN"&&s.classList.contains("label")&&s.matches(a)&&g([s])})})}).observe(document.documentElement,{childList:!0,subtree:!0,characterData:!0});const E={clipboardButton:!0,clipboardButtonCopiedBadge:"Copied",clipboardButtonErrorBadge:null,lineNumbers:!1,languageBadge:!1,themes:{light:"github-light",dark:"github-dark"}},L=`
import { codeToHtml } from 'https://esm.sh/shiki@3.2';

const { on } = window.ivent;
const options = OPTIONS;

function detectLanguage(codeText) {
	const languages = {
		// Special formats first (to avoid false positives)
		json: /^\\s*[{\\[](?:\\"|\\'|$).*[}\\]]\\s*$/,
		yaml: /^(?:---|\\s*[\\w-]+:\\s*(?:(?:>|\\||-|\\[|\\{)|(?:\\S+)))/,

		// Markup languages
		markdown: /^(?:#{1,6}\\s|[*-]\\s|\\d+\\.\\s|>\\s|\\[.*\\]\\(.*\\)|\`{3}|_{2}|\\*{2})/m,
		html: /^\\s*(?:<(?:!DOCTYPE\\s+html|html|head|body|div|span|a|p|script|style|link|meta)[\\s>])/i,

		// Strongly typed languages
		typescript:
			/(?:^|\\b)(?:interface\\s+\\w+|type\\s+\\w+|enum\\s+\\w+|readonly|private|protected|public|abstract|implements|namespace|declare)\\b/,
		'c++':
			/(?:^|\\b)(?:#include\\s*<\\w+>|using\\s+namespace\\s+std|template\\s*<|class\\s+\\w+|public:|private:|protected:)\\b/,
		java: /(?:^|\\b)(?:public\\s+class|private\\s+class|protected\\s+class|package\\s+[\\w.]+;|import\\s+[\\w.]+;)\\b/,
		'c#': /(?:^|\\b)(?:namespace\\s+[\\w.]+|using\\s+[\\w.]+;|public\\s+class|private\\s+class|protected\\s+class)\\b/,

		// Scripting languages
		python:
			/(?:^|\\b)(?:def\\s+\\w+\\s*\\(|class\\s+\\w+(?:\\s*\\([\\w,\\s]*\\))?:|import\\s+[\\w,\\s]+|from\\s+[\\w.]+\\s+import)\\b/,
		javascript:
			/(?:^|\\b)(?:function\\s+\\w+\\s*\\(|const\\s+\\w+\\s*=|let\\s+\\w+\\s*=|var\\s+\\w+\\s*=|import\\s+.*from\\s+['"]|export\\s+(?:default\\s+)?(?:function|class|const|let|var))\\b/,
		php: /(?:^|\\b)(?:<\\?php|namespace\\s+[\\w\\\\]+;|use\\s+[\\w\\\\]+;|class\\s+\\w+(?:\\s+extends|\\s+implements)?)\\b/,
		ruby: /(?:^|\\b)(?:require\\s+['"][\\w/]+['"]|class\\s+\\w+\\s*(?:<\\s*\\w+)?|def\\s+\\w+|module\\s+\\w+)\\b/,

		// Modern languages
		rust: /(?:^|\\b)(?:fn\\s+\\w+|impl\\s+\\w+|pub\\s+(?:fn|struct|enum|trait)|use\\s+[\\w:]+;|let\\s+mut\\s+\\w+)\\b/,
		go: /(?:^|\\b)(?:package\\s+\\w+|func\\s+\\w+|type\\s+\\w+\\s+struct|import\\s+(?:\\([\\s\\S]*?\\)|\\S+))\\b/,
		swift:
			/(?:^|\\b)(?:import\\s+\\w+|class\\s+\\w+|struct\\s+\\w+|protocol\\s+\\w+|extension\\s+\\w+)\\b/,
		kotlin:
			/(?:^|\\b)(?:fun\\s+\\w+|class\\s+\\w+|data\\s+class|object\\s+\\w+|interface\\s+\\w+)\\b/,
		dart: /(?:^|\\b)(?:void\\s+main\\(\\)|class\\s+\\w+|abstract\\s+class|extends\\s+\\w+|implements\\s+\\w+)\\b/,

		// Query languages
		sql: /(?:^|\\b)(?:SELECT\\s+(?:\\*|\\w+)|INSERT\\s+INTO|UPDATE\\s+\\w+\\s+SET|DELETE\\s+FROM|CREATE\\s+TABLE|DROP\\s+TABLE|ALTER\\s+TABLE)\\b/i,

		// Scientific/Statistical languages
		r: /(?:^|\\b)(?:library\\(\\w+\\)|function\\s*\\(|data\\.frame\\(|<-|%>%)\\b/,
		matlab:
			/(?:^|\\b)(?:function\\s+\\w+\\s*=|classdef\\s+\\w+|properties|methods|end)\\b/,

		// Shell scripting
		bash: /^(?:#!\\s*\\/bin\\/(?:ba)?sh|(?:\\b(?:if|then|else|elif|fi|for|do|done|while|case|esac|function)\\b|\\$\\{|\\$\\(|export\\s+\\w+))/,

		// Styling
		css: /(?:^|\\b)(?:@media|@import|@keyframes|\\{[\\s\\S]*?\\}|[a-z-]+:\\s*[^;]+;)/,
	};

	for (const [language, regex] of Object.entries(languages)) {
		if (regex.test(codeText)) {
			return language;
		}
	}

	return 'text';
}

async function init() {
	document
		.querySelectorAll('pre:not(.shiki) > code')
		.forEach(async (code) => {
			let preEl = code.parentNode;
			let wrapper = preEl.parentNode;

			// Add wrapper.
			if (!wrapper.classList.contains('kg-code-card')) {
				wrapper = document.createElement('div');
				wrapper.classList.add('kg-card', 'kg-code-card');
				preEl.after(wrapper);
				wrapper.appendChild(preEl);
			}

			// Has line numbers.
			if (options.lineNumbers) {
				wrapper.classList.add('has-line-numbers');
			}

			preEl.classList.add('shiki');

			const lang = code?.classList[0]?.replace('language-', '') || detectLanguage(code?.innerText || '');
			const themes = options?.themes || {};

			const codeText = code?.innerText;
			const codeHTML = await codeToHtml(codeText || '', {
				lang,
				themes,
			});

			// Add copy button.
			if (options.clipboardButton && codeText) {
				const button = document.createElement('button');
				button.classList.add('copy');
				button.setAttribute('data-copy-code', '');
				button.setAttribute('role', 'button');
				button.setAttribute('aria-label', 'Copy code');

				// Badge success.
				if (options.clipboardButtonCopiedBadge) {
					const badge = document.createElement('span');
					badge.classList.add('success');
					badge.textContent = options.clipboardButtonCopiedBadge;
					button.append(badge);
				}

				// Badge error.
				if (options.clipboardButtonErrorBadge) {
					const badge = document.createElement('span');
					badge.classList.add('error');
					badge.textContent = options.clipboardButtonErrorBadge;
					button.append(badge);
				}

				wrapper.appendChild(button);

				let timeoutSuccess = null;
				let timeoutError = null;

				on(button, 'click', async (e) => {
					e.preventDefault();

					timeoutSuccess && clearTimeout(timeoutSuccess);
					timeoutError && clearTimeout(timeoutError);

					button.classList.remove('error');
					button.classList.remove('success');

					// Success.
					try {
						await navigator.clipboard.writeText(codeText);

						button.classList.add('success');
						timeoutSuccess = setTimeout(() => {
							button.classList.remove('success');
						}, 2000);

					// Error.
					} catch (err) {
						console.error(err);

						button.classList.add('error');
						timeoutError = setTimeout(() => {
							button.classList.remove('error');
						}, 2000);
					}
				});
			}

			// Add language badge.
			if (options.languageBadge && lang) {
				const badge = document.createElement('span');
				badge.classList.add('language-badge');
				badge.textContent = lang;
				wrapper.append(badge);
			}

			// Add code HTML.
			if (codeHTML) {
				preEl.outerHTML = codeHTML;
			}
		});
}

init();

// Update when render page.
on(document, 'ready pvs.navigation.content-rendered pvs.filter.rendered pvs.pagination.rendered', () => {
	init();
});
`;function T(e={}){const t={...E,...e},s=document.createElement("script");s.type="module",s.innerHTML=L.replace("OPTIONS",JSON.stringify(t)),document.head.appendChild(s)}const{on:y}=window.ivent,x={selector:'a:not([target="_blank"])',target:"_blank",rel:"noopener noreferrer"},p=[];function m(){p.forEach(({selector:e,target:t,rel:s})=>{const o=location.host.replace("www.","");document.querySelectorAll(e).forEach(n=>{if(!n.host.includes(o)&&(t&&n.setAttribute("target",t),s)){const r=n.getAttribute("rel");if(r){const u=r.split(" "),_=s.split(" "),z=Array.from(new Set([...u,..._])).join(" ");n.setAttribute("rel",z)}else n.setAttribute("rel",s)}})})}function S(e={}){const t={...x,...e};p.some(s=>s.selector===t.selector)||(p.push(t),m())}y(document,"ready pvs.navigation.content-rendered pvs.filter.rendered pvs.pagination.rendered",m);let f=!1;function k(e=!0){f=e}function C(){return f&&!document.body.classList.contains("tag-hash-lightbox")||document.body.classList.contains("tag-hash-disable-lightbox")}const{on:A}=window.ivent,l=[];function w(){l.length&&l.forEach(({slug:e,icon:t})=>{document.querySelectorAll(".nav-link > svg").forEach(s=>{const o=s.parentNode,n=o.querySelector("span");(o.classList.contains(`nav-link-${e}`)||e===n?.textContent.trim())&&(s.outerHTML=t)})})}function h(e,t){l.some(s=>s.slug===e)||(l.push({slug:e,icon:t}),w())}A(document,"ready",w);const{on:B,trigger:N}=window.ivent,c=[],$={target:"_blank",rel:"noopener noreferrer"};function M(){return c}function b(){c.length&&(document.querySelectorAll(".social-links:not(.social-links-author)").forEach(e=>{c.forEach(t=>{if(e.querySelector(`a[href="${t.url}"]`))return;const s=document.createElement("li");s.innerHTML=`<a class="social-link" href="${t.url}" target="${t.options.target}" rel="${t.options.rel}">${t.icon}<span>${t.title}</span></a>`,e.appendChild(s)})}),N(document,"pvs.social-links.rendered"))}function O(e,t,s,o={}){if(c.some(r=>r.url===e))return;const n={...$,...o};c.push({url:e,title:t,icon:s,options:n}),b()}B(document,"ready pvs.navigation.content-rendered pvs.filter.rendered pvs.pagination.rendered",b);let d={};function H(e={}){return d={...d,...e,initialized:!0},d}function j(){return d}const v=new Map;function q(e,t,s){return v.set(`${e}:${t}`,s)}function D(e,t){return v.get(`${e}:${t}`)}function I(e){return e.replace(/#.*/,"")}async function P(e,t=!0,s={}){const o=I(e);if(t){const u=D("ajax",o);if(u)return u}const n=await fetch(o,s);if(!n.ok)throw n.status;const r=await n.text();return q("ajax",o,r),r}function R(e){return new DOMParser().parseFromString(e,"text/html")}var U={version:"2.1.1",ajax:P,parseHTML:R,addSocialLink:O,getSocialLinks:M,renderSocialLinks:b,addNavIcon:h,addExternalLinkAttributes:S,initCodeHighlight:T,initTOC:H,getTOCUserOptions:j,disableLightbox:k,isLightboxDisabled:C,addMenuIcon(...e){return console.error("pvs.addMenuIcon is deprecated. Use pvs.addNavIcon instead."),h(...e)}};return U});
