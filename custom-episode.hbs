{{!< default}}

{{#post}}
{{#contentFor "body-class"}} post-template-episode{{/contentFor}}

<article class="content post tag-hash-episode page">

    <style>
        .cinema-mode {
            width: 100%; background: #000; margin-top: var(--spacing-8);
            border-radius: var(--radius-4); overflow: hidden;
            aspect-ratio: 16/9; box-shadow: var(--shadow);
            display: flex; align-items: center; justify-content: center;
        }
        .cinema-mode iframe, .cinema-mode video { width: 100%; height: 100%; }
        
        .episode-layout {
            display: grid; grid-template-columns: 1fr 350px; gap: var(--layout--gap);
            margin-top: var(--spacing-9);
        }
        .timeline-list { list-style: none; padding: 0; margin: 0; border-left: 2px solid var(--color-border); }
        .timeline-item { padding-left: 20px; margin-bottom: 15px; position: relative; }
        .timeline-item.active { border-left: 2px solid var(--ghost-accent-color); margin-left: -2px; font-weight: bold; }
        .timeline-item a { text-decoration: none; color: var(--color-foreground); display: block; }
        .timeline-item span { display: block; font-size: 0.8rem; color: var(--color-secondary); }
        
        @media(max-width: 900px) { .episode-layout { grid-template-columns: 1fr; } .episode-sidebar { order: 2; } }
    </style>

    <div class="container-wide">
        
        {{!-- 1. VIDEO PLAYER (Cinema Mode) --}}
        <div class="cinema-mode">
             {{#if feature_image}}
                {{!-- If you use an image as placeholder or have an iframe in content, logic goes here --}}
                <img src="{{img_url feature_image size="xl"}}" style="width:100%; height:100%; object-fit:cover; opacity:0.8;">
                <div style="position:absolute; z-index:2; color:#fff; font-size:1.5rem; font-weight:bold;">
                    {{!-- This is where your video embed from content usually goes, or a play button --}}
                    {{t "Video Player Area"}}
                </div>
             {{/if}}
        </div>

        {{!-- 2. CONTENT & SIDEBAR --}}
        <div class="episode-layout">
            
            <div class="episode-main">
                <header style="margin-bottom: var(--spacing-7); border-bottom: 1px solid var(--color-border); padding-bottom: 20px;">
                    {{#if primary_tag}}
                        {{#get "posts" filter=(concat "tags:hash-webseries+tags:" primary_tag.slug) limit="1"}}
                            {{#foreach posts}}
                                <a href="{{url}}" style="text-transform:uppercase; font-size:0.8rem; font-weight:bold; color:var(--color-secondary); text-decoration:none; display:block; margin-bottom:10px;">
                                    &larr; {{t "Back to Series"}}: {{title}}
                                </a>
                            {{/foreach}}
                        {{/get}}
                    {{/if}}
                    <h1 class="post-title">{{title}}</h1>
                    <p style="font-size:1.2rem; color:var(--color-secondary);">{{custom_excerpt}}</p>
                </header>

                {{!-- Main Content Body --}}
                <div class="post-content">
                    {{content}}
                </div>

                {{!-- In-Article Ad --}}
                <div class="post-ad" style="margin: 40px 0;">
                    {{> "adsense" type="in-article" }}
                </div>

                {{!-- Comments --}}
                {{> "post/comments"}}
            </div>

            <aside class="episode-sidebar">
                <div style="position:sticky; top:100px;">
                    <div class="sidebar-card" style="background:var(--color-background-100); padding:25px; border-radius:var(--radius-4); border:1px solid var(--color-border);">
                        <h3 style="font-size:1.1rem; margin-bottom:20px;">{{t "Up Next"}}</h3>
                        
                        {{#if primary_tag}}
                            {{#get "posts" filter=(concat "tags:hash-episode+tags:" primary_tag.slug) order="published_at asc"}}
                                <ul class="timeline-list">
                                    {{#foreach posts}}
                                    <li class="timeline-item {{#if current}}active{{/if}}">
                                        <a href="{{url}}">{{title}}</a>
                                        <span>{{reading_time}}</span>
                                    </li>
                                    {{/foreach}}
                                </ul>
                            {{/get}}
                        {{/if}}
                    </div>

                    {{!-- Rectangle Ad --}}
                    <div style="margin-top:30px;">
                        {{> "adsense" type="rectangle" }}
                    </div>
                </div>
            </aside>

        </div>
    </div>

</article>
{{/post}}