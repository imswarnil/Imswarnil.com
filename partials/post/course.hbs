{{!< default}}

<style>
    /* --- 1. GLOBAL LAYOUT & VARS --- */
    .course-container {
        max-width: var(--container-wide--width);
        margin: 0 auto;
        padding: var(--spacing-8) var(--layout--padding);
        display: flex;
        flex-direction: column;
        gap: var(--spacing-9);
    }

    /* Separator Line */
    .course-separator {
        border: 0;
        border-top: 1px solid var(--color-border);
        margin: var(--spacing-9) 0;
        opacity: 0.6;
        width: 100%;
    }

    /* --- 2. HERO SECTION --- */
    .course-hero {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--spacing-8);
        align-items: center;
    }

    @media (min-width: 992px) {
        .course-hero { grid-template-columns: 1.2fr 1fr; }
    }

    .course-tag {
        color: var(--ghost-accent-color);
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        background: var(--color-background-100);
        padding: 4px 10px;
        border-radius: 4px;
        display: inline-block;
        margin-bottom: var(--spacing-4);
    }

    .course-title {
        font-family: var(--font-family-headings);
        font-size: clamp(2rem, 4vw, 3rem);
        font-weight: 800;
        line-height: 1.1;
        color: var(--color-contrast);
        margin: 0 0 var(--spacing-4) 0;
    }

    .course-excerpt {
        font-size: 1.15rem;
        color: var(--color-secondary);
        margin: 0 0 var(--spacing-6) 0;
        line-height: 1.5;
    }

    .course-meta {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-5);
        margin-bottom: var(--spacing-6);
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--color-foreground);
    }

    .course-hero-media {
        border-radius: var(--radius-4);
        overflow: hidden;
        aspect-ratio: 16/9;
        box-shadow: var(--shadow);
        background: var(--color-background-200);
    }
    
    .course-hero-media img {
        width: 100%; height: 100%; object-fit: cover;
    }

    /* --- 3. MAIN GRID LAYOUT --- */
    .course-body-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--spacing-9);
        align-items: start;
    }

    @media (min-width: 992px) {
        .course-body-grid { grid-template-columns: 1fr 380px; /* Sidebar Width */ }
    }

    /* --- 4. IMPROVED CURRICULUM CARDS --- */
    .curriculum-container {
        border: 1px solid var(--color-border);
        border-radius: var(--radius-4);
        overflow: hidden;
        background: var(--color-background);
        box-shadow: 0 10px 30px -10px rgba(0,0,0,0.05);
    }

    .curriculum-header {
        background: var(--color-background-100);
        padding: 20px 25px;
        border-bottom: 1px solid var(--color-border);
        display: flex; justify-content: space-between; align-items: center;
    }
    .curriculum-header h3 { margin: 0; font-size: 1.25rem; }

    .course-lesson-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .course-lesson-item {
        border-bottom: 1px solid var(--color-border);
        transition: background-color 0.2s ease;
    }
    .course-lesson-item:last-child { border-bottom: none; }
    
    .course-lesson-item:hover {
        background-color: var(--color-background-100);
    }

    .course-lesson-link {
        display: grid;
        grid-template-columns: auto 1fr auto; /* Thumb | Text | Icon */
        gap: 20px;
        align-items: center;
        padding: 20px;
        min-height: 110px; /* Large, bold height */
        text-decoration: none !important;
        color: var(--color-foreground) !important;
    }

    /* Thumbnail Styles */
    .lesson-thumb {
        width: 120px;
        height: 75px;
        border-radius: var(--radius-2);
        object-fit: cover;
        background: var(--color-background-300);
        border: 1px solid var(--color-border);
        flex-shrink: 0;
    }
    
    .lesson-thumb-placeholder {
        width: 120px; height: 75px;
        border-radius: var(--radius-2);
        background: var(--color-background-200);
        display: flex; align-items: center; justify-content: center;
        font-size: 1.2rem; font-weight: bold; color: var(--color-secondary);
        border: 1px solid var(--color-border);
        flex-shrink: 0;
    }

    /* Lesson Text */
    .lesson-info h4 {
        margin: 0 0 5px 0;
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--color-contrast);
        line-height: 1.3;
    }
    .lesson-meta {
        font-size: 0.85rem;
        color: var(--color-secondary);
        display: flex; gap: 10px; align-items: center;
    }

    /* Right Status Icon */
    .lesson-status-box {
        width: 45px; height: 45px;
        border-radius: 50%;
        background: var(--color-background);
        border: 1px solid var(--color-border);
        display: flex; align-items: center; justify-content: center;
        transition: all 0.2s;
    }

    .course-lesson-item:hover .lesson-status-box {
        border-color: var(--ghost-accent-color);
        transform: scale(1.05);
    }

    .icon-lock { color: var(--color-mute); width: 20px; height: 20px; }
    .icon-play { color: var(--ghost-accent-color); fill: currentColor; width: 20px; height: 20px; }

    /* --- 5. STICKY SIDEBAR --- */
    .course-sidebar-sticky {
        position: sticky;
        top: 100px;
        display: flex;
        flex-direction: column;
        gap: var(--spacing-7);
    }

    .enroll-card {
        background: var(--color-background);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-4);
        padding: 30px;
        box-shadow: var(--shadow);
        text-align: center;
    }

    .course-price {
        font-family: var(--font-family-headings);
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--color-contrast);
        display: block;
        margin-bottom: 10px;
    }
    
    .course-features-list {
        text-align: left; list-style: none; padding: 0; margin: 20px 0 0 0;
        font-size: 0.9rem; color: var(--color-secondary);
        display: flex; flex-direction: column; gap: 10px;
    }

    /* --- 6. MARKETING COMPONENTS --- */
    .wyl-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }
    .wyl-card {
        background: var(--color-background-100);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-3);
        padding: 25px;
    }
    .wyl-card h4 { margin: 15px 0 5px 0; font-weight: 700; font-size: 1.1rem; }
    .wyl-card p { margin: 0; font-size: 0.95rem; color: var(--color-secondary); }
    
    /* Ads */
    .ad-block {
        background: repeating-linear-gradient(45deg, var(--color-background-100), var(--color-background-100) 10px, var(--color-background-200) 10px, var(--color-background-200) 20px);
        border: 2px dashed var(--color-border);
        display: flex; align-items: center; justify-content: center;
        color: var(--color-mute); font-weight: bold; font-size: 0.9rem;
    }
    .ad-leaderboard { width: 100%; height: 120px; margin: 40px 0; }
    .ad-square { width: 100%; aspect-ratio: 1/1; }

    /* Testimonials */
    .testimonial-grid { display: grid; gap: 20px; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); margin-top: 40px; }
    .testimonial-card { padding: 30px; background: var(--color-background-100); border-radius: var(--radius-4); }
    
    @media (max-width: 600px) {
        .lesson-thumb, .lesson-thumb-placeholder { display: none; } 
        .course-lesson-link { grid-template-columns: 1fr auto; padding: 15px; }
    }
</style>

<div class="course-container">

    {{!-- 1. HERO SECTION --}}
    <div class="course-hero">
        <div class="course-hero-content">
            {{#primary_tag}}
                <span class="course-tag">{{name}}</span>
            {{/primary_tag}}
            
            <h1 class="course-title">{{title}}</h1>
            
            {{#if custom_excerpt}}
                <p class="course-excerpt">{{custom_excerpt}}</p>
            {{/if}}

            <div class="course-meta">
                {{#if reading_time}}
                    <div style="display:flex; align-items:center; gap:5px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                        <span>{{reading_time}}</span>
                    </div>
                {{/if}}
                
                {{#if authors}}
                    <div style="display:flex; align-items:center; gap:5px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                        <span>{{authors}}</span>
                    </div>
                {{/if}}
                
                <div style="display:flex; align-items:center; gap:5px;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                    <span>Updated {{date format="MMM YYYY"}}</span>
                </div>
            </div>

            {{!-- HERO CTA --}}
            <div style="margin-top: 20px;">
                <a href="#curriculum" class="button button-primary" style="padding: 12px 30px; font-size: 1.1rem;">Start Learning</a>
            </div>
        </div>

        <div class="course-hero-media">
            {{#if feature_image}}
                <img src="{{img_url feature_image size="l"}}" alt="{{title}}">
            {{/if}}
        </div>
    </div>

    {{!-- SEPARATOR LINE --}}
    <hr class="course-separator">
    
    {{!-- AD BLOCK --}}
    <div class="ad-block ad-leaderboard">ADVERTISEMENT (970x90)</div>

    {{!-- 2. MAIN CONTENT GRID --}}
    <div class="course-body-grid">
        
        {{!-- LEFT: CONTENT --}}
        <div class="course-main">
            
            {{!-- What You Will Learn --}}
            <h2 style="margin-bottom: 25px;">What you'll learn</h2>
            <div class="wyl-grid">
                <div class="wyl-card">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--ghost-accent-color)" stroke-width="2"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>
                    <h4>Fundamentals</h4>
                    <p>Grasp the core concepts needed to master this skill.</p>
                </div>
                <div class="wyl-card">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--ghost-accent-color)" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                    <h4>Real Projects</h4>
                    <p>Apply what you learn with hands-on exercises.</p>
                </div>
                <div class="wyl-card">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--ghost-accent-color)" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                    <h4>Certification</h4>
                    <p>Earn a certificate upon completion.</p>
                </div>
            </div>

            {{!-- Course Description --}}
            <section style="margin-bottom: 50px;">
                <h2 style="margin-bottom: 20px;">About This Course</h2>
                <div class="post-content">
                    {{content}}
                </div>
            </section>

            {{!-- CURRICULUM --}}
            <section id="curriculum">
                <h2 style="margin-bottom: 25px;">Course Curriculum</h2>

                <div class="curriculum-container">
                    <div class="curriculum-header">
                        <h3>Lessons</h3>
                        <span style="font-size:0.9rem; color:var(--color-secondary);">Full Access</span>
                    </div>

                    {{!-- 
                        DYNAMIC LESSON FETCH & JSON-LD 
                        Logic: Fetch posts with primary tag AND #lessons-col tag
                    --}}
                    {{#get "posts" 
                        filter="tag:{{primary_tag.slug}}+tag:hash-lessons-col" 
                        include="tags" 
                        order="published_at asc" 
                        limit="100" 
                        as |lessons|
                    }}
                    
                    {{!-- JSON-LD SCRIPT INJECTION --}}
                    <script type="application/ld+json">
                    {
                        "@context": "https://schema.org",
                        "@type": "Course",
                        "name": "{{../title}}",
                        "description": "{{../custom_excerpt}}",
                        "provider": {
                            "@type": "Organization",
                            "name": "{{@site.title}}",
                            "sameAs": "{{@site.url}}"
                        },
                        "image": [
                            "{{img_url ../feature_image absolute="true"}}"
                        ],
                        "hasCourseInstance": {
                            "@type": "CourseInstance",
                            "courseMode": "online",
                            "instructor": [
                                {{#foreach ../authors}}
                                {
                                    "@type": "Person",
                                    "name": "{{name}}",
                                    "image": "{{img_url profile_image absolute="true"}}"
                                }{{^if @last}},{{/if}}
                                {{/foreach}}
                            ]
                        },
                        "hasPart": [
                            {{#foreach lessons}}
                            {
                                "@type": "CourseModule",
                                "name": "{{title}}",
                                "description": "{{excerpt}}",
                                "url": "{{url absolute="true"}}"
                            }{{^if @last}},{{/if}}
                            {{/foreach}}
                        ]
                    }
                    </script>

                    {{#if lessons}}
                        <ul class="course-lesson-list">
                            {{#foreach lessons}}
                                <li class="course-lesson-item">
                                    <a href="{{url}}" class="course-lesson-link">
                                        
                                        {{!-- 1. Thumbnail --}}
                                        {{#if feature_image}}
                                            <img src="{{img_url feature_image size="s"}}" class="lesson-thumb" alt="{{title}}">
                                        {{else}}
                                            <div class="lesson-thumb-placeholder">{{@number}}</div>
                                        {{/if}}

                                        {{!-- 2. Text Info --}}
                                        <div class="lesson-info">
                                            <h4>{{title}}</h4>
                                            <div class="lesson-meta">
                                                <span>{{#if reading_time}}{{reading_time}}{{else}}Lesson {{@number}}{{/if}}</span>
                                            </div>
                                        </div>

                                        {{!-- 3. Status Icon --}}
                                        <div class="lesson-status-box">
                                            {{#if access}}
                                                {{!-- PLAY ICON (Unlocked) --}}
                                                <svg class="status-icon icon-play" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0"><path d="M8 5v14l11-7z" fill="currentColor"></path></svg>
                                            {{else}}
                                                {{!-- LOCK ICON (Locked) --}}
                                                <svg class="status-icon icon-lock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                                            {{/if}}
                                        </div>

                                    </a>
                                </li>
                            {{/foreach}}
                        </ul>
                    {{else}}
                        <div style="padding:40px; text-align:center; color:var(--color-secondary);">
                            No lessons available yet.
                        </div>
                    {{/if}}
                    {{/get}}
                </div>
            </section>

        </div>

        {{!-- RIGHT: STICKY SIDEBAR --}}
        <aside class="course-sidebar-sticky">
            
            <!-- Subscription Card -->
            <div class="enroll-card">
                {{#if access}}
                    <h3 style="margin-top:0;">You have access!</h3>
                    <p style="color:var(--color-secondary); margin-bottom:20px;">Jump back in and continue learning.</p>
                    <a href="#curriculum" class="button button-primary" style="width:100%; justify-content:center;">Go to Curriculum</a>
                {{else}}
                    <span class="course-price">Subscribe</span>
                    <p style="color: var(--color-secondary); margin-bottom: 20px;">Unlock this course and all premium content.</p>
                    
                    <!-- Ghost Portal Logic -->
                    <button data-portal="signup" class="button button-primary" style="width: 100%; justify-content: center;">Enroll Now</button>
                    
                    <p style="font-size: 0.8rem; color: var(--color-mute); margin-top: 15px;">30-Day Money-Back Guarantee</p>
                    
                    <hr style="margin: 20px 0; border-color:var(--color-border);">
                    
                    <ul class="course-features-list">
                        <li><svg style="width:16px; color:var(--color-success);" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg> Full Access</li>
                        <li><svg style="width:16px; color:var(--color-success);" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg> Project Files</li>
                        <li><svg style="width:16px; color:var(--color-success);" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg> Community</li>
                    </ul>
                {{/if}}
            </div>

            <!-- Sidebar Ad -->
            <div class="ad-block ad-square">SQUARE AD (300x250)</div>

        </aside>
    </div>
    
    {{!-- 4. MARKETING SECTIONS (Hardcoded) --}}
    
    <section style="padding-top: 50px; border-top: 1px solid var(--color-border);">
        <h2 style="text-align:center; margin-bottom:40px;">Student Success Stories</h2>
        <div class="testimonial-grid">
            <div class="testimonial-card">
                <p>"The structured approach in this course helped me launch my project in record time."</p>
                <strong>— Sarah J.</strong>
            </div>
            <div class="testimonial-card">
                <p>"Worth every penny. The curriculum is well thought out and easy to follow."</p>
                <strong>— Mike T.</strong>
            </div>
            <div class="testimonial-card">
                <p>"I love the practical examples. It's not just theory, it's real-world application."</p>
                <strong>— Jessica R.</strong>
            </div>
        </div>
    </section>

    <section style="padding: 60px 0; text-align:center;">
        <h2 style="margin-bottom:20px;">Ready to get started?</h2>
        <p style="margin-bottom:30px; color:var(--color-secondary);">Join thousands of students today.</p>
        <button data-portal="signup" class="button button-primary" style="padding:15px 40px; font-size:1.2rem;">Enroll Now</button>
    </section>

</div>
